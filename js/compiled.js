!function(t){var e={};function n(i){if(e[i])return e[i].exports;var s=e[i]={i:i,l:!1,exports:{}};return t[i].call(s.exports,s,s.exports,n),s.l=!0,s.exports}n.m=t,n.c=e,n.d=function(t,e,i){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var s in t)n.d(i,s,function(e){return t[e]}.bind(null,s));return i},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=13)}([function(t,e){t.exports=jQuery},function(t,e){t.exports=Vue},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e){t.exports=Vuex},function(t,e){t.exports=VueRouter},function(t,e){t.exports=dragula},function(t,e,n){t.exports=n(24)},function(t,e,n){},function(t,e){},function(t,e,n){"use strict";var i=n(2);n.n(i).a},function(t,e,n){"use strict";var i=n(3);n.n(i).a},function(t,e,n){"use strict";var i=n(4);n.n(i).a},function(t,e,n){"use strict";var i=n(5);n.n(i).a},function(t,e,n){"use strict";var i=n(6);n.n(i).a},function(t,e,n){"use strict";var i=n(7);n.n(i).a},function(t,e,n){"use strict";var i=n(8);n.n(i).a},function(t,e,n){"use strict";var i=n(9);n.n(i).a},function(t,e,n){"use strict";n.r(e);n(14);var i=n(1),s=n.n(i),o=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"app"},[n("div",{staticClass:"header"},[n("h1",{on:{click:function(e){return t.gotoIndex()}}},[t._v("CrowdSpec")]),t._v(" "),n("span",[t._v(t._s(t.username))]),t._v(" "),n("el-button",{attrs:{size:"mini"},on:{click:function(e){return t.logout()}}},[t._v("Log out")])],1),t._v(" "),n("div",{staticClass:"content-area"},[n("router-view")],1)])};o._withStripped=!0;var r=n(0),c=n.n(r),l=n(10),a=n.n(l);s.a.use(a.a);var u=c()(window),d=new a.a.Store({state:{windowWidth:u.width(),dragging:!1,moving:null},getters:{userID:function(t){return window.user.id},username:function(t){return window.user.username},dialogTinyWidth:function(t){return t.windowWidth<=767?"80%":t.windowWidth<=991?"50%":"30%"},dialogSmallWidth:function(t){return t.windowWidth<=767?"90%":t.windowWidth<=991?"75%":"50%"},dialogLargeWidth:function(t){return t.windowWidth<=991?"95%":"90%"}},mutations:{setWindowWidth:function(t,e){t.windowWidth=e},startDragging:function(t){t.dragging=!0},endDragging:function(t){t.dragging=!1},startMoving:function(t,e){t.moving=e},endMoving:function(t){t.moving=null}}}),p=d;u.on("resize",(function(){d.commit("setWindowWidth",u.width())}));var f=n(11),h=n.n(f),m=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"index-page"},[n("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.promptCreateSpec()}}},[t._v("New spec")]),t._v(" "),n("div",{staticClass:"user-specs"},[n("h2",[t._v("Your specs")]),t._v(" "),t.loading?n("p",[t._v("Loading...")]):t.userSpecs&&t.userSpecs.length?n("ul",t._l(t.userSpecs,(function(e){return n("li",{key:e.id},[n("router-link",{attrs:{to:{name:"spec",params:{specId:e.id}}}},[t._v(t._s(e.name))])],1)})),0):n("p",[t._v("You do not have any specs.")])]),t._v(" "),n("edit-spec-modal",{ref:"editSpecModal"})],1)};m._withStripped=!0;var v=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("el-dialog",{staticClass:"spec-edit-spec-modal",attrs:{title:t.spec?"Manage spec":"Create spec",visible:t.showing,width:t.$store.getters.dialogSmallWidth,"close-on-click-modal":!1},on:{"update:visible":function(e){t.showing=e},closed:function(e){return t.closed()}}},[n("label",[t._v("\n\t\tName\n\t\t"),n("el-input",{ref:"nameInput",attrs:{clearable:""},model:{value:t.name,callback:function(e){t.name=e},expression:"name"}})],1),t._v(" "),n("label",[t._v("\n\t\tDescription\n\t\t"),n("el-input",{attrs:{type:"textarea",autosize:{minRows:2}},model:{value:t.desc,callback:function(e){t.desc=e},expression:"desc"}})],1),t._v(" "),t.spec?n("p",[t._v("Created "+t._s(t.spec.created))]):t._e(),t._v(" "),n("span",{directives:[{name:"loading",rawName:"v-loading",value:t.sending,expression:"sending"}],staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{on:{click:function(e){t.showing=!1}}},[t._v("Cancel")]),t._v(" "),t.spec?n("el-button",{attrs:{type:"danger"},on:{click:function(e){return t.promptDeleteSpec()}}},[t._v("Delete")]):t._e(),t._v(" "),n("el-button",{attrs:{type:"primary",disabled:t.disableSubmit},on:{click:function(e){return t.submit()}}},[t._v(t._s(t.spec?"Save":"Create"))])],1)])};function b(t){if(console.error(t),t){var e=null;if(0===t.readyState?e="Could not connect to server":t.readyState&&t.status?e="Request failed with error code "+t.status:t.message?e=t.message:"string"==typeof t&&(e=t),e)return void s.a.prototype.$alert(e,"Error",{confirmButtonText:"Ok",type:"error"})}s.a.prototype.$alert("An error occurred",{confirmButtonText:"Ok",type:"error"})}v._withStripped=!0;n(15);function g(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}function _(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?g(Object(n),!0).forEach((function(e){k(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):g(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function k(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function y(t){return c.a.get("/ajax/spec",{specId:t}).fail(b)}function w(t,e,n,i){return c.a.post("/ajax/spec/move-block",{blockId:t,subspaceId:e,parentId:n,insertBeforeId:i}).fail(b)}var I={data:function(){return{name:"",desc:"",spec:null,callback:null,showing:!1,sending:!1}},computed:{disableSubmit:function(){return!this.name.trim()}},methods:{showCreate:function(t){var e=this;this.callback=t,this.showing=!0,this.$nextTick((function(){c()("input",e.$refs.nameInput.$el).focus()}))},showEdit:function(t,e){var n=this;this.spec=t,this.name=t.name,this.desc=t.desc,this.callback=e,this.showing=!0,this.$nextTick((function(){c()("input",n.$refs.nameInput.$el).focus()}))},submit:function(){this.disableSubmit||(this.spec?this.submitSave():this.submitCreate())},submitCreate:function(){var t=this;if(!this.disableSubmit){this.sending=!0;var e,n,i=this.callback;(e=this.name,n=this.desc,c.a.post("/ajax/spec/create-spec",{name:e,desc:n}).fail(b)).then((function(e){i(e),t.showing=!1,t.sending=!1})).fail((function(){t.sending=!1}))}},submitSave:function(){var t=this;this.sending=!0;var e,n,i,s=this.callback;(e=this.spec.id,n=this.name,i=this.desc,c.a.post("/ajax/spec/save-spec",{specId:e,name:n,desc:i}).fail(b)).then((function(e){s(e),t.showing=!1,t.sending=!1})).fail((function(){t.sending=!1}))},promptDeleteSpec:function(){var t=this;this.$confirm("Permanently delete this spec?",{confirmButtonText:"Delete",cancelButtonText:"Cancel",type:"warning"}).then((function(){var e;t.sending=!0,(e=t.spec.id,c.a.post("/ajax/spec/delete-spec",{specId:e}).fail(b)).then((function(){t.sending=!1,t.showing=!1,t.$router.push({name:"index"})})).fail((function(){t.sending=!1}))})).catch((function(){}))},closed:function(){this.spec=null,this.name="",this.desc=""}}};n(16);function T(t,e,n,i,s,o,r,c){var l,a="function"==typeof t?t.options:t;if(e&&(a.render=e,a.staticRenderFns=n,a._compiled=!0),i&&(a.functional=!0),o&&(a._scopeId="data-v-"+o),r?(l=function(t){(t=t||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(t=__VUE_SSR_CONTEXT__),s&&s.call(this,t),t&&t._registeredComponents&&t._registeredComponents.add(r)},a._ssrRegister=l):s&&(l=c?function(){s.call(this,this.$root.$options.shadowRoot)}:s),l)if(a.functional){a._injectStyles=l;var u=a.render;a.render=function(t,e){return l.call(e),u(t,e)}}else{var d=a.beforeCreate;a.beforeCreate=d?[].concat(d,l):[l]}return{exports:t,options:a}}var x=T(I,v,[],!1,null,null,null);x.options.__file="src/spec/edit-spec-modal.vue";var $=x.exports,S={components:{EditSpecModal:$},data:function(){return{userSpecs:[],loading:!0}},mounted:function(){this.reloadSpecs()},beforeRouteUpdate:function(t,e,n){this.reloadSpecs(),n()},methods:{reloadSpecs:function(){var t=this;this.loading=!0,c.a.get("/ajax/user-specs").then((function(e){t.userSpecs=e,t.loading=!1})).fail((function(e){t.loading=!1,b(e)}))},promptCreateSpec:function(){var t=this;this.$refs.editSpecModal.showCreate((function(e){t.$router.push({name:"spec",params:{specId:e}})}))}}},C=(n(17),T(S,m,[],!1,null,null,null));C.options.__file="src/pages/index.vue";var B=C.exports,j=function(){var t=this,e=t.$createElement,n=t._self._c||e;return t.spec?n("section",{staticClass:"spec-page"},[n("header",[n("h2",[n("div",{staticClass:"right"},[t.currentUserOwns?n("span",[t._v("You own this")]):n("span",[t._v("Owned by "+t._s(t.spec.ownerType)+" "+t._s(t.spec.ownerId))]),t._v(" "),t.spec.public?n("span",[t._v("Public")]):n("span",[t._v("Not public")]),t._v(" "),n("el-button",{attrs:{size:"mini",icon:"el-icon-setting"},on:{click:function(e){return t.openManageSpec()}}})],1),t._v("\n\t\t\t"+t._s(t.name)+"\n\t\t")]),t._v(" "),t.desc?n("div",{staticClass:"desc"},[t._v(t._s(t.desc))]):t._e()]),t._v(" "),n("spec-view",{attrs:{spec:t.spec}}),t._v(" "),n("edit-spec-modal",{ref:"editSpecModal"})],1):t._e()};j._withStripped=!0;var O=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"spec-view"},[n("ul",{ref:"list",staticClass:"spec-block-list",class:{dragging:t.dragging}}),t._v(" "),n("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(e){return t.promptAddBlock()}}},[t._v("Add block")]),t._v(" "),n("ul",{ref:"mirrorList",staticClass:"mirror-list"}),t._v(" "),n("edit-block-modal",{ref:"editBlockModal",attrs:{"spec-id":t.spec.id}})],1)};O._withStripped=!0;var A=n(12),P=n.n(A),U=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("li",{staticClass:"spec-block",class:t.classes,attrs:{"data-spec-block":t.block.id}},[n("div",{staticClass:"content"},[n("div",{staticClass:"bg"}),t._v(" "),t.title?n("div",{staticClass:"title"},[n("div",{staticClass:"layover",on:{mouseleave:function(e){return t.cancelChooseAddPosition()}}},[t.choosingAddPosition?[n("el-button",{attrs:{type:"warning",size:"mini",icon:"el-icon-close",circle:""},on:{click:function(e){return t.cancelChooseAddPosition()}}}),t._v(" "),n("el-button",{attrs:{type:"primary",size:"mini",icon:"el-icon-top",circle:""},on:{click:function(e){return t.addBeforeThis()}}}),t._v(" "),n("el-button",{attrs:{type:"primary",size:"mini",icon:"el-icon-bottom-right",circle:""},on:{click:function(e){return t.addIntoThis()}}}),t._v(" "),n("el-button",{attrs:{type:"primary",size:"mini",icon:"el-icon-bottom",circle:""},on:{click:function(e){return t.addAfterThis()}}})]:t.movingThis?[n("el-button",{attrs:{type:"warning",size:"mini",icon:"el-icon-close"},on:{click:function(e){return t.cancelMoving()}}},[t._v("Cancel move")])]:t.movingAnother?[n("el-button",{attrs:{type:"warning",size:"mini",icon:"el-icon-close",circle:""},on:{click:function(e){return t.cancelMoving()}}}),t._v(" "),n("el-button",{attrs:{type:"primary",size:"mini",icon:"el-icon-top",circle:""},on:{click:function(e){return t.moveBeforeThis()}}}),t._v(" "),n("el-button",{attrs:{type:"primary",size:"mini",icon:"el-icon-bottom-right",circle:""},on:{click:function(e){return t.moveIntoThis()}}}),t._v(" "),n("el-button",{attrs:{type:"primary",size:"mini",icon:"el-icon-bottom",circle:""},on:{click:function(e){return t.moveAfterThis()}}})]:[n("el-button",{attrs:{type:"default",size:"mini",icon:"el-icon-edit",circle:""},on:{click:function(e){return t.editBlock()}}}),t._v(" "),n("el-button",{attrs:{type:"warning",size:"mini",icon:"el-icon-delete",circle:""},on:{click:function(e){return t.promptDeleteBlock()}}}),t._v(" "),n("el-button",{attrs:{type:"primary",size:"mini",icon:"el-icon-plus",circle:""},on:{click:function(e){return t.enterChooseAddPosition()}}}),t._v(" "),n("i",{staticClass:"el-icon-d-caret drag-handle",on:{click:function(e){return t.startMoving()}}})]],2),t._v("\n\t\t\t"+t._s(t.title)+"\n\t\t")]):t._e(),t._v(" "),"url"===t.refType&&t.refItem?n("ref-url",{staticClass:"ref-item",attrs:{item:t.refItem}}):t._e(),t._v(" "),t.body?n("div",{staticClass:"body"},[t._v(t._s(t.body))]):t._e()],1),t._v(" "),n("ul",{ref:"sublist",staticClass:"spec-block-list",class:{moving:t.movingThis}})])};U._withStripped=!0;var R=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"ref-url"},[t.item.imageData?n("img",{attrs:{src:t.item.imageData}}):t._e(),t._v(" "),n("div",[n("div",{staticClass:"title"},[n("i",{staticClass:"el-icon-link"}),t._v(" "),n("a",{attrs:{href:t.item.url}},[t._v(t._s(t.item.title&&t.item.title.trim()||t.item.url))])]),t._v(" "),t.item.desc?n("div",{staticClass:"desc"},[t._v(t._s(t.item.desc.trim()))]):t._e()])])};R._withStripped=!0;var E={props:{item:Object}},M=(n(18),T(E,R,[],!1,null,null,null));M.options.__file="src/spec/ref-url.vue";var D=M.exports,z={components:{RefUrl:D},props:{block:Object},data:function(){return{styleType:this.block.styleType,contentType:this.block.contentType,refType:this.block.refType,refId:this.block.refId,title:this.block.title,body:this.block.body,refItem:this.block.refItem,subblocks:this.block.subblocks?this.block.subblocks.slice():[],choosingAddPosition:!1}},computed:{classes:function(){return[this.styleType]},movingThis:function(){return this.$store.state.moving===this.block.id},movingAnother:function(){return this.$store.state.moving&&!this.movingThis}},methods:{getBlockId:function(){return this.block.id},getParentId:function(){var t=c()(this.$el).parent().closest("[data-spec-block]");return t.length?t.attr("data-spec-block"):null},getFollowingBlockId:function(){var t=c()(this.$el).next("[data-spec-block]");return t.length?t.attr("data-spec-block"):null},editBlock:function(){var t=this;this.raiseOpenEdit({id:this.block.id,styleType:this.styleType,contentType:this.contentType,refType:this.refType,refId:this.refId,refItem:this.refItem,title:this.title,body:this.body},(function(e){t.styleType=e.styleType,t.contentType=e.contentType,t.refType=e.refType,t.refId=e.refId,t.refItem=e.refItem,t.title=e.title,t.body=e.body,t.refItem=e.refItem}))},raiseOpenEdit:function(t,e){this.$emit("open-edit",t,e)},promptDeleteBlock:function(){var t=this;this.raisePromptDeleteBlock(this.block.id,(function(){c()(t.$el).remove()}))},raisePromptDeleteBlock:function(t,e){this.$emit("prompt-delete-block",t,e)},enterChooseAddPosition:function(){this.choosingAddPosition=!0},cancelChooseAddPosition:function(){this.choosingAddPosition=!1},addBeforeThis:function(){var t=this.getParentId(),e=this.block.id;this.raisePromptAddSubblock(null,t,e)},addIntoThis:function(){var t=this.block.id;this.raisePromptAddSubblock(null,t,null)},addAfterThis:function(){var t=this.getParentId(),e=this.getFollowingBlockId();this.raisePromptAddSubblock(null,t,e)},raisePromptAddSubblock:function(t,e,n){this.$emit("prompt-add-subblock",t,e,n)},startMoving:function(){this.$store.commit("startMoving",this.block.id)},cancelMoving:function(){this.$store.commit("endMoving")},moveBeforeThis:function(){var t=this,e=this.$store.state.moving,n=this.getParentId(),i=this.block.id;w(e,null,n,i).then((function(){c()('[data-spec-block="'+e+'"]').insertBefore(t.$el),t.$store.commit("endMoving")}))},moveIntoThis:function(){var t=this,e=this.$store.state.moving,n=this.block.id;w(e,null,n,null).then((function(){c()('[data-spec-block="'+e+'"]').appendTo(t.$refs.sublist),t.$store.commit("endMoving")}))},moveAfterThis:function(){var t=this,e=this.$store.state.moving,n=this.getParentId(),i=this.getFollowingBlockId();w(e,null,n,i).then((function(){c()('[data-spec-block="'+e+'"]').insertAfter(t.$el),t.$store.commit("endMoving")}))}}},W=(n(19),T(z,U,[],!1,null,null,null));W.options.__file="src/spec/block.vue";var N=W.exports,L=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("el-dialog",{staticClass:"spec-edit-block-modal",attrs:{title:t.block?"Edit block":"Add block",visible:t.showing,width:t.$store.getters.dialogSmallWidth,"close-on-click-modal":!1},on:{"update:visible":function(e){t.showing=e},closed:function(e){return t.closed()}}},[n("el-radio-group",{model:{value:t.styleType,callback:function(e){t.styleType=e},expression:"styleType"}},[n("el-radio",{attrs:{label:"bullet"}},[t._v("Bullet point")]),t._v(" "),n("el-radio",{attrs:{label:"numbered"}},[t._v("Numbered point")]),t._v(" "),n("el-radio",{attrs:{label:"none"}},[t._v("Indented block")])],1),t._v(" "),n("label",[t._v("\n\t\tTitle\n\t\t"),n("el-input",{ref:"titleInput",attrs:{clearable:""},model:{value:t.title,callback:function(e){t.title=e},expression:"title"}})],1),t._v(" "),n("label",[t._v("\n\t\tBody\n\t\t"),n("el-input",{attrs:{type:"textarea",autosize:{minRows:2}},model:{value:t.body,callback:function(e){t.body=e},expression:"body"}})],1),t._v(" "),n("el-radio-group",{model:{value:t.refType,callback:function(e){t.refType=e},expression:"refType"}},[n("el-radio",{attrs:{label:null}},[t._v("No media")]),t._v(" "),n("el-radio",{attrs:{label:"url"}},[t._v("URL")])],1),t._v(" "),"url"===t.refType?n("div",{staticClass:"ref-url-area"},[n("el-input",{model:{value:t.url,callback:function(e){t.url=e},expression:"url"}},[n("template",{slot:"prepend"},[t._v("URL")])],2),t._v(" "),t.existingUrlRefItem?[t.existingUrlRefItem.url===t.url?n("ref-url",{attrs:{item:t.existingUrlRefItem}}):t._e(),t._v(" "),t.showRefreshUrl?n("el-checkbox",{model:{value:t.refreshUrl,callback:function(e){t.refreshUrl=e},expression:"refreshUrl"}},[t._v("\n\t\t\t\tRefresh URL preview\n\t\t\t")]):t.refreshUrl?n("p",[t._v("URL preview will be updated")]):t._e()]:t._e()],2):t._e(),t._v(" "),n("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{on:{click:function(e){t.showing=!1}}},[t._v("Cancel")]),t._v(" "),n("el-button",{attrs:{type:"primary",disabled:t.disableSubmit},on:{click:function(e){return t.submit()}}},[t._v("\n\t\t\t"+t._s(t.block?"Save":"Add")+"\n\t\t")])],1)],1)};L._withStripped=!0;var F={components:{RefUrl:D},props:{specId:Number},data:function(){return{styleType:"bullet",title:"",body:"",refType:null,url:"",refreshUrl:!1,block:null,subspaceId:null,parentId:null,insertBeforeId:null,callback:null,showing:!1}},computed:{disableSubmit:function(){if(!this.refType)return!(this.title.trim()||this.body.trim());switch(this.refType){case"url":return this.url,!1;default:return!0}},existingUrlRefItem:function(){return this.block&&"url"===this.block.refType&&this.block.refItem},showRefreshUrl:function(){return this.existingUrlRefItem&&this.existingUrlRefItem.url===this.url}},watch:{url:function(t){this.existingUrlRefItem&&(this.refreshUrl=this.existingUrlRefItem.url!==this.url)}},methods:{showAdd:function(t,e,n,i){var s=this;this.subspaceId=t,this.parentId=e,this.insertBeforeId=n,this.callback=i,this.showing=!0,this.$nextTick((function(){c()("input",s.$refs.titleInput.$el).focus()}))},showEdit:function(t,e){var n=this;this.block=t,this.styleType=t.styleType,this.title=t.title,this.body=t.body,this.refType=t.refType,this.callback=e,"url"===t.refType&&t.refItem&&(this.url=t.refItem.url),this.showing=!0,this.$nextTick((function(){c()("input",n.$refs.titleInput.$el).focus()}))},submit:function(){this.disableSubmit||(this.block?this.submitSave():this.submitAdd())},submitAdd:function(){var t=this,e=this.createSendingSpinner(),n=this.callback,i=null;"url"===this.refType&&(this.url,1)&&(i={refType:"url",refUrl:this.url}),function(t,e,n,i,s,o,r,l,a){return a=a||{},c.a.post("/ajax/spec/create-block",_({specId:t,subspaceId:e,parentId:n,insertBeforeId:i,styleType:s,contentType:o,title:r,body:l},a)).fail(b)}(this.specId,this.subspaceId,this.parentId,this.insertBeforeId,this.styleType,"plaintext",this.title,this.body,i).then((function(i){n(i),t.showing=!1,e.close()})).fail((function(){e.close()}))},submitSave:function(){var t=this,e=this.createSendingSpinner(),n=this.callback,i=null;"url"===this.refType&&(i={refType:"url",refId:this.existingUrlRefItem?this.existingUrlRefItem.id:null,refUrl:this.url,refRefreshUrl:this.refreshUrl}),function(t,e,n,i,s,o,r){return r=r||{},c.a.post("/ajax/spec/save-block",_({specId:t,blockId:e,styleType:n,contentType:i,title:s,body:o},r)).fail(b)}(this.specId,this.block.id,this.styleType,"plaintext",this.title,this.body,i).then((function(i){n(i),t.showing=!1,e.close()})).fail((function(){e.close()}))},createSendingSpinner:function(){return this.$loading({lock:!0,background:"rgba(0, 0, 0, 0.7)"})},closed:function(){this.block=null,this.subspaceId=null,this.parentId=null,this.insertBeforeId=null,this.callback=null,this.title="",this.body="",this.refType=null,this.url="",this.refreshUrl=!1}}},V=(n(20),T(F,L,[],!1,null,null,null));V.options.__file="src/spec/edit-block-modal.vue";var q=V.exports,Y=s.a.extend(N),X={components:{EditBlockModal:q},props:{spec:Object},data:function(){return{autoscroller:null}},computed:{dragging:function(){return this.$store.state.dragging}},watch:{dragging:function(t){t?this.autoscroller=function(){var t=c()(window),e=null,n=null;function i(t){n=t.clientY}return t.on("mousemove",i),e=window.requestAnimationFrame((function i(){if(null!==n){var s=t.height(),o=0;if(n<70)o=-(8*((70-n)/70)+1);else if(n>s-70){o=8*((n-(s-70))/70)+1}0!==o&&t.scrollTop(t.scrollTop()+o)}console.log("requesting"),e=window.requestAnimationFrame(i)})),{stop:function(){t.off("mousemove",i),e&&(window.cancelAnimationFrame(e),e=null)}}}():this.autoscroller&&this.autoscroller.stop()}},mounted:function(){var t=this;if(this.spec.blocks)for(var e=function e(n,i){for(var s=0;s<i.length;s++){var o=i[s],r=t.insertBlock(o,!1);c()(">ul.spec-block-list",n).append(r),o.subblocks&&e(r,o.subblocks)}},n=0;n<this.spec.blocks.length;n++){var i=this.spec.blocks[n],s=this.insertBlock(i);i.subblocks&&e(s,i.subblocks)}this.drake=P()({isContainer:function(t){return c()(t).is(".spec-block-list")},accepts:function(t,e,n,i){return!c()(e).closest(".gu-transit").length},moves:function(t,e,n,i){return c()(n).is(".drag-handle")},mirrorContainer:this.$refs.mirrorList}).on("drag",(function(e,n){t.$store.commit("startDragging")})).on("dragend",(function(e){t.$store.commit("endDragging")})).on("drop",(function(t,e,n,i){var s=c()(e).closest("[data-spec-block]"),o=s.length?s.data("vc").getBlockId():null,r=i?c()(i).data("vc").getBlockId():null;w(c()(t).data("vc").getBlockId(),null,o,r)}))},methods:{insertBlock:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=new Y({store:p,propsData:{block:t}}).$mount();n.$on("open-edit",this.openEdit),n.$on("prompt-add-subblock",this.promptAddSubblock),n.$on("prompt-delete-block",this.promptDeleteBlock);var i=c()(n.$el).data("vc",n);return e&&i.appendTo(this.$refs.list),i},promptAddBlock:function(){this.$refs.editBlockModal.showAdd(null,null,null,this.insertBlock)},openEdit:function(t,e){this.$refs.editBlockModal.showEdit(t,e)},promptAddSubblock:function(t,e,n){var i=this;this.$refs.editBlockModal.showAdd(t,e,n,(function(t){var s=i.insertBlock(t,!1);n?s.insertBefore('[data-spec-block="'+n+'"]'):e?s.appendTo('[data-spec-block="'+e+'"]>ul.spec-block-list'):s.appendTo(i.$refs.list)}))},promptDeleteBlock:function(t,e){this.$confirm("Delete block and subblocks?","Confirm",{confirmButtonText:"Delete",cancelButtonText:"Cancel",type:"warning"}).then((function(){(function(t){return c.a.post("/ajax/spec/delete-block",{blockId:t}).fail(b)})(t).then(e)})).catch((function(){}))}}},Q=(n(21),T(X,O,[],!1,null,null,null));Q.options.__file="src/spec/view.vue";var G={components:{SpecView:Q.exports,EditSpecModal:$},data:function(){return{spec:null,name:"",desc:""}},computed:{currentUserOwns:function(){return"user"===this.spec.ownerType&&this.$store.getters.userID===this.spec.ownerId}},beforeRouteEnter:function(t,e,n){y(t.params.specId).then((function(t){n((function(e){e.setSpec(t)}))})).fail((function(t){n({name:"ajax-error",params:{code:t.status},replace:!0})}))},beforeRouteUpdate:function(t,e,n){var i=this;y(t.params.specId).then((function(t){i.setSpec(t),n()})).fail((function(t){n({name:"ajax-error",params:{code:t.status},replace:!0})}))},methods:{setSpec:function(t){this.spec=t,this.name=t.name,this.desc=t.desc},openManageSpec:function(){var t=this;this.$refs.editSpecModal.showEdit({id:this.spec.id,name:this.name,desc:this.desc,created:this.spec.created},(function(e){t.name=e.name,t.desc=e.desc}))}}},H=(n(22),T(G,j,[],!1,null,null,null));H.options.__file="src/pages/spec.vue";var J=H.exports,K=function(){var t=this.$createElement;return(this._self._c||t)("div",[0===parseInt(this.$route.params.code,10)?[this._v("\n\t\tCould not connect to server\n\t")]:[this._v("\n\t\tRequest failed with error code "+this._s(this.$route.params.code)+"\n\t")]],2)};K._withStripped=!0;var Z=T({},K,[],!1,null,null,null);Z.options.__file="src/pages/ajax-error.vue";var tt=Z.exports,et=function(){var t=this.$createElement;return(this._self._c||t)("div",[this._v("\n\tNot found\n")])};et._withStripped=!0;var nt=T({},et,[],!1,null,null,null);nt.options.__file="src/pages/not-found.vue";var it=nt.exports,st=new h.a({mode:"history",routes:[{name:"index",path:"/",component:B},{name:"spec",path:"/spec/:specId",component:J},{name:"ajax-error",path:"/ajax-error/:code",component:tt},{path:"*",component:it}]}),ot={store:p,router:st,computed:{username:function(){return this.$store.getters.username}},methods:{gotoIndex:function(){"index"!==this.$route.name&&this.$router.push({name:"index"})},logout:function(){window.location.href="/logout"}}},rt=(n(23),T(ot,o,[],!1,null,null,null));rt.options.__file="src/app.vue";var ct=rt.exports;new s.a(ct).$mount("#app")}]);